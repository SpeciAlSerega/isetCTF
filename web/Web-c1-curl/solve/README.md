## i_set_VPS

| Событие | Название | Категория | Сложность |
|:--------|:---------|:----------|----------:|
| isetCTF 2020 | i_set_VPS | Web | Easy |

### Описание
> Автор: [ dikidikiday ]
>
> Наконец-то я  купил себе [VPS](http://ваш_сайт:1337) !!! Теперь я хочу научится тут работать. Решил начать с сетевых утилит, установил парочку.

> Я не могу потерять свои файлы, и очень боюсь, что **кто-то может их посмотреть...**

### Решение

![](imgs/1.jpg)

Переходим на сайт и видим форму. Пробуем вставить `ya.ru` и действительно получаем ответ команды curl.
Видим, что посылается GET запрос, на что указывает "?" в url, вспоминаем про последовательное выполнениее команд в консоли.
Для этого служит символ точка с запятой ;
Пробуем подставить `ya.ru;ls`

![](imgs/2.jpg)
Вуаля! Видим в конце выполнение команды `ls`

> Можно даже не писать `ya.ru`, а сразу `;`

Но тут очень много папок и файлов с `flag`, как же определить, где же нужный ?

Вводим команду, чтобы зайти в первую папку `flag` без номера:
`;ls flag`, но ничего не происходит. Как так ?
Несложно понять, что на стороне сервера происходит фильтрация некоторых элементов и пробел в их числе.

Ищем в гугле `Bypass without space command injection`, вот:
`$IFS$9` или `${IFS}`

Вводим `;ls$IFS$9flag`, видим `flag.txt`, открываем `;cat${IFS}flag/flag.txt`, а в ответ
`it's not a flag =) try harder.`
Понимаем, что забрели в кроличью нору, ищем дальше.

Так как за этот таск дается не очень много очков, понимаем, что вряд ли решением будет написать скрипт, который перебирает все директории с именем `flag-{000..100}`, в каждой из которых еще лежит какой-то мусор.

Внезапно в конце вывода видим файлик `flag.txt` в корне сайта.
Вводим `;cat${IFS}flag.txt` и получаем флаг:
`WOW! There is a vulnerability on my server! Secret data from the Urals: iset{w3_L1K3_C0MM4nd_1nj3C710N}`

**Флаг:**

> iset{w3_L1K3_C0MM4nd_1nj3C710N}
